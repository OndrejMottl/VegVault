# VegVault Database Structure

Currently, VegVault consists of 31 interconnected tables with 87 fields (variables), which are described in detail below. However, the internal database structure may not be directly relevant to most users, as the [{vaultkeepr}](https://bit.ly/vaultkeepr) R package processes all data to output only the most relevant information in a "ready-to-analyze" format.

::: {.callout-note}
**For Most Users**: If you're primarily interested in using VegVault for research, you may want to start with our [Usage Examples](/website/database_examples.qmd) rather than diving into the technical database structure.
:::

This section provides comprehensive documentation of all tables and their relationships for users who need detailed technical information about the database architecture.

```{r}
#| label: source config
#| include: FALSE
#| results: 'hide'
#| warning: FALSE
#| message: FALSE

library(here)

here::i_am("website/database_structure/_01_Description_of_VegVault.qmd")

# Load configuration
source(
  here::here(
    "R/00_Config_file.R"
  )
)

source(
  here::here(
    "R/03_Visualisation/00_Config_quarto.R"
  )
)

invisible(
  lapply(
    list.files(
      path = here::here("R/Functions"),
      pattern = "*.R",
      recursive = TRUE,
      full.names = TRUE
    ),
    source
  )
)

```

## Metadata Tables

Several tables contain metadata and administrative information that are not directly linked to the scientific data:

- **`Authors`**: Information about VegVault authors and maintainers, including contact details
- **`version_control`**: Database version information with descriptions of changes over time  
- **`sqlite_stat1` & `sqlite_stat4`**: SQLite system tables containing database index statistics for query optimization

```{r}
#| label: Authors variables scheme structure
#| tbl-cap: "Column names and types for table Authors."
data_comments_authors <-
  tibble::tribble(
    ~column_name, ~description,
    "author_id", "ID of an Author (unique)",
    "author_fullname", "Full name of an Author",
    "author_email", "Contact email of an Author",
    "author_orcid", "ORCID ID of an Author"
  )

get_db_table_data_types(
  con,
  "Authors"
) %>%
  dplyr::full_join(
    data_comments_authors,
    by = "column_name"
  ) %>%
  plot_table()
```

```{r}
#| label: Version Control variables scheme structure
#| tbl-cap: "Column names and types for table version_control."
data_comments_version_control <-
  tibble::tribble(
    ~column_name, ~description,
    "id", "ID of a database version (unique)",
    "version", "Version number",
    "update_date", "Date of the creation of that version",
    "changelog", "Text description of main changes in the database"
  )

get_db_table_data_types(
  con,
  "version_control"
) %>%
  dplyr::full_join(
    data_comments_version_control,
    by = "column_name"
  ) %>%
  plot_table()
```
