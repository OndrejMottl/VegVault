---
date: 2025/01/24
date-format: long
date-modified: last-modified
format:
  html:
    fig-width: 10
sidebar: true
---

# Database content

```{r}
#| label: source config
#| include: FALSE
#| results: 'hide'
#| warning: FALSE
#| message: FALSE

library(here)

here::i_am("website/database_content.qmd")

# Load configuration
source(
  here::here(
    "R/00_Config_file.R"
  )
)

source(
  here::here(
    "R/03_Visualisation/00_Config_quarto.R"
  )
)

```

## Database Content Overview

VegVault v1.0.0 is a comprehensive [SQLite database]{.text-background-brownDark .text-color-white .text-bold} (~110 GB) that integrates global vegetation data spanning both [contemporary]{.text-background-greenLight .text-color-black .text-bold} and [paleovegetation]{.text-background-purpleLight .text-color-black .text-bold} records. This unified database combines [fossil pollen]{.text-background-purpleLight .text-color-black .text-bold} records, [contemporary vegetation plots]{.text-background-greenLight .text-color-black .text-bold}, [functional trait]{.text-background-blueDark .text-color-white .text-bold} measurements, and associated [abiotic environmental data]{.text-background-greenDark .text-color-white .text-bold} to provide an unprecedented resource for vegetation ecology research.

The database consists of 31 interconnected tables with 87 fields (variables). For detailed technical information, see our [Database Structure](/website/database_structure.qmd) documentation.

## Database Statistics

**VegVault v1.0.0 contains:**

|||
|-----|-----|
| **Datasets** | > 480,000 |  
| **Samples** | > 13,000,000|
| **Taxa** | > 110,000|
| **Vegetation Traits** | 6|
| **Trait Values** | > 11,000,000|
| **Abiotic Variables** | 8|
| **Geographic Coverage** | Global |
| **Temporal Coverage** | 0-20,000 years BP |

::: {.callout-tip}
**Getting Started**: New to [VegVault]{.text-background-black .text-color-white .text-bold}? Check our [Database Access](/website/database_access.qmd) guide for download instructions and our [Usage Examples](/website/database_examples.qmd) for practical applications.
:::


## Spatio-temporal overview of the database content

```{r}
data_vegetation_samples <-
  vaultkeepr::open_vault(
    path = path_to_vegvault # [config]
  ) %>%
  # Add the dataset information
  vaultkeepr::get_datasets() %>%
  # Select modern plot data and climate
  vaultkeepr::select_dataset_by_type(
    sel_dataset_type = c(
      "vegetation_plot",
      "fossil_pollen_archive"
    )
  ) %>%
  # Add samples
  vaultkeepr::get_samples() %>%
  # select only modern data
  # Add abiotic data
  vaultkeepr::extract_data(
    return_raw_data = TRUE,
    verbose = FALSE
  ) %>%
  dplyr::mutate(
    dataset_type = stringr::str_replace_all(
      dataset_type,
      "_",
      " "
    )
  )

data_vegetation_samples_space <-
  data_vegetation_samples %>%
  dplyr::distinct(dataset_type, coord_long, coord_lat)

data_vegetation_samples_time <-
  data_vegetation_samples %>%
  dplyr::distinct(dataset_id, dataset_type, age)

fig_world_empty <-
  tibble::tibble() %>%
  ggplot2::ggplot() +
  ggplot2::borders(
    fill = col_black,
    col = NA
  ) +
  ggplot2::labs(
    x = "Longitude",
    y = "Latitude"
  ) +
  ggplot2::scale_y_continuous(breaks = seq(-90, 90, by = 30)) +
  ggplot2::scale_x_continuous(breaks = seq(-180, 180, by = 60))

fig_vegetation_space <-
  fig_world_empty +
  ggplot2::geom_point(
    data = data_vegetation_samples_space,
    mapping = ggplot2::aes(
      x = coord_long,
      y = coord_lat,
      col = dataset_type
    ),
    size = point_size / 10, # [config]
    alpha = 0.5
  ) +
  ggplot2::scale_color_manual(
    values = palette_dataset_type # [config]
  ) +
  ggplot2::guides(
    color = ggplot2::guide_legend(override.aes = list(size = point_size))
  ) +
  ggplot2::theme(
    legend.position = "top",
  ) +
  ggplot2::coord_sf()

fig_vegetation_time <-
  data_vegetation_samples_time %>%
  ggplot2::ggplot(
    ggplot2::aes(
      x = age,
      y = ggplot2::after_stat(count)
    )
  ) +
  ggplot2::geom_histogram(
    ggplot2::aes(
      fill = dataset_type
    ),
    alpha = 1,
    bins = 20
  ) +
  ggplot2::scale_fill_manual(
    values = palette_dataset_type # [config]
  ) +
  ggplot2::scale_y_continuous(
    transform = scales::transform_log1p(),
    breaks = c(1, 10, 100, 1e3, 1e4, 1e5, 1e6, 1e7, 1e8, 1e9),
    labels = c("1", "10", "100", "1e3", "1e4", "1e5", "1e6", "1e7", "1e8", "1e9")
  ) +
  ggplot2::scale_x_continuous(
    breaks = seq(0, 20e3, by = 5e3),
    labels = seq(0, 20, by = 5)
  ) +
  ggplot2::coord_cartesian(
    xlim = c(0.2, 20e3),
    ylim = c(1, 1e9)
  ) +
  ggplot2::guides(
    color = ggplot2::guide_legend(override.aes = list(size = point_size))
  ) +
  ggplot2::theme(
    legend.position = "top"
  ) +
  ggplot2::labs(
    x = "Age (ka cal yr BP)",
    y = "Number of Samples",
    fill = "Dataset Type"
  )

fig_legend <-
  cowplot::get_plot_component(
    fig_vegetation_time,
    "guide-box-top",
    return_all = TRUE
  )

fig_vegetation <-
  cowplot::plot_grid(
    fig_vegetation_space +
      ggplot2::theme(
        legend.position = "none"
      ),
    fig_vegetation_time +
      ggplot2::theme(
        legend.position = "none"
      ),
    nrow = 1,
    rel_widths = c(1.5, 1)
  ) %>%
  cowplot::plot_grid(
    fig_legend,
    .,
    nrow = 2,
    rel_heights = c(0.1, 1)
  )

plot(fig_vegetation, bg = col_beige_light)
```

## Related Resources

- **[Database Structure](/website/database_structure.qmd)** - Technical database schema
- **[Database Assembly](/website/database_assembly.qmd)** - Overview of the data assembly process
- **[Database Access](/website/database_access.qmd)** - Download and setup instructions
- **[Usage Examples](/website/database_examples.qmd)** - Practical applications
- **[Materials & Outputs](/website/materials.qmd)** - Publications and resources 